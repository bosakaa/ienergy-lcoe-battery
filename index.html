<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang-key="appTitle">Калькулятор усередненої вартості електроенергії (LCOE) для установок зберігання енергії (BESS)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="text-gray-900">
    <div id="side-menu" class="fixed top-0 left-0 h-full w-64 bg-gray-800 text-white z-20 shadow-lg">
        <div class="p-4"> <h2 class="text-xl font-semibold" data-lang-key="menu">Меню</h2> </div>
        <nav>
            <a href="#" data-target="calculator-page" class="nav-link block py-2.5 px-4 hover:bg-gray-700" data-lang-key="calculator">Калькулятор</a>
            <a href="#" data-target="formulas-page" class="nav-link block py-2.5 px-4 hover:bg-gray-700" data-lang-key="formulas">Формули</a>
            <a href="#" data-target="contacts-page" class="nav-link block py-2.5 px-4 hover:bg-gray-700" data-lang-key="contacts">Контакти</a>
        </nav>
    </div>

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-6xl">
        <header class="text-left mb-6 flex items-center justify-between">
            <div class="flex items-center">
                <button id="menu-toggle" class="p-2 mr-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
                <div>
                    <p class="text-sm text-gray-600" data-lang-key="instituteName">Інститут загальної енергетики НАН України</p>
                    <h1 class="text-2xl font-light text-gray-900 mt-1" data-lang-key="appHeader">Калькулятор усередненої вартості електроенергії (LCOE) для установок зберігання енергії (BESS)</h1>
                </div>
            </div>
            <div class="lang-switch text-sm">
                <a id="lang-uk" class="active">UA</a> | <a id="lang-en">EN</a>
            </div>
        </header>

        <main>
            <div id="calculator-page" class="page-content win-card p-6 sm:p-8">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <section>
                        <h2 class="text-xl font-light mb-4 border-b border-gray-300 pb-2" data-lang-key="techParams">Технічні параметри</h2>
                        <div class="input-group">
                            <label for="batteryType" class="input-label" data-lang-key="batteryType">Тип батареї</label>
                            <select id="batteryType" class="select-field">
                                <option value="nmc" data-lang-key="option_nmc">NMC (Збалансований)</option>
                                <option value="lfp" data-lang-key="option_lfp">LFP (Довговічний)</option>
                                <option value="nca" data-lang-key="option_nca">NCA (Високоенергетичний)</option>
                                <option value="li-ion" data-lang-key="option_liion">Li-ion (Високий ресурс)</option>
                                <option value="na-ion" data-lang-key="option_naion">Na-ion (Перспективний)</option>
                            </select>
                            <span class="tooltip-text" data-lang-key-html="tooltip_batteryType">Оберіть хімію акумулятора. Це автоматично оновить типові значення ККД та деградації.</span>
                        </div>
                        <div class="input-group">
                            <label for="systemPower" class="input-label" data-lang-key="systemPower">Потужність системи</label>
                            <div class="relative">
                                <input type="number" id="systemPower" class="input-field pr-14" value="50">
                                <span class="unit">МВт</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_systemPower">Максимальна потужність, з якою система може заряджатися/розряджатися.<br><br>Типовий діапазон: 50 - 100 МВт.</span>
                        </div>
                        <div class="input-group">
                            <label for="systemCapacity" class="input-label" data-lang-key="systemCapacity">Ємність системи</label>
                            <div class="relative">
                                <input type="number" id="systemCapacity" class="input-field pr-20" value="200">
                                <span class="unit">МВт·год</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_systemCapacity">Загальна кількість енергії, яку може зберігати батарея.<br><br>Типовий діапазон: 200 - 400 МВт·год (для 4-годинних систем).</span>
                        </div>
                        <div class="input-group">
                            <label for="rte" class="input-label" data-lang-key="rte">ККД повного циклу (RTE)</label>
                            <div class="relative">
                                <input type="number" id="rte" class="input-field pr-12" value="88">
                                <span class="unit">%</span>
                            </div>
                             <span class="tooltip-text" data-lang-key-html="tooltip_rte">Відсоток енергії, що повертається під час розрядки, відносно енергії, витраченої на зарядку.<br><br>Типовий діапазон: 88% - 91%.</span>
                        </div>
                        <div class="input-group">
                            <label for="dod" class="input-label" data-lang-key="dod">Глибина розряду (DoD)</label>
                            <div class="relative">
                                <input type="number" id="dod" class="input-field pr-12" value="90">
                                <span class="unit">%</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_dod">Відсоток від повної ємності, що використовується в кожному циклі.<br><br>Типове значення: 90%.</span>
                        </div>
                        <div class="input-group">
                            <label for="cyclesPerYear" class="input-label" data-lang-key="cyclesPerYear">Кількість циклів на рік</label>
                            <div class="relative">
                                <input type="number" id="cyclesPerYear" class="input-field pr-20" value="350">
                                <span class="unit" data-lang-key="unit_cycles">циклів</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_cyclesPerYear">Очікувана кількість повних циклів заряду-розряду протягом року.<br><br>Типове значення: 350.</span>
                        </div>
                         <div class="input-group">
                            <label for="degradationRate" class="input-label" data-lang-key="degradationRate">Річна деградація ємності</label>
                            <div class="relative">
                                <input type="number" id="degradationRate" class="input-field pr-12" value="1.5">
                                <span class="unit">%</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_degradationRate">Відсоток втрати максимальної ємності батареї щороку через зношення.<br><br>Типове значення: ~2.6%.</span>
                        </div>
                    </section>
                    <section>
                        <h2 class="text-xl font-light mb-4 border-b border-gray-300 pb-2" data-lang-key="costParams">Параметри витрат</h2>
                        <div class="input-group">
                            <label for="capex" class="input-label" data-lang-key="capex">Капітальні витрати (CAPEX)</label>
                            <div class="relative">
                                <input type="number" id="capex" class="input-field pr-24" value="350">
                                <span class="unit">$/кВт·год</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_capex">Початкові інвестиційні витрати на обладнання, монтаж та введення в експлуатацію.<br><br>Типовий діапазон (storage): $249 - $421/кВт·год.</span>
                        </div>
                        <div class="input-group">
                            <label for="omCost" class="input-label" data-lang-key="omCost">Фіксовані витрати на O&M</label>
                            <div class="relative">
                                <input type="number" id="omCost" class="input-field pr-24" value="12">
                                <span class="unit">$/кВт-рік</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_omCost">Щорічні витрати на обслуговування, моніторинг та страхування.<br><br>Типовий діапазон (PV): $11 - $14/кВт-рік.</span>
                        </div>
                        <div class="input-group">
                            <label for="chargingCost" class="input-label" data-lang-key="chargingCost">Вартість енергії для зарядки</label>
                            <div class="relative">
                                <input type="number" id="chargingCost" class="input-field pr-24" value="40">
                                <span class="unit">$/МВт·год</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_chargingCost">Середня ціна, за якою система купує електроенергію з мережі для зарядки.<br><br>Типове значення (standalone): ~$51/МВт·год.</span>
                        </div>
                        <div class="input-group">
                            <label for="replacementCost" class="input-label" data-lang-key="replacementCost">Вартість заміни</label>
                             <div class="relative">
                                <input type="number" id="replacementCost" class="input-field pr-24" value="60">
                                <span class="unit" data-lang-key="unit_ofCapex">% від CAPEX</span>
                             </div>
                             <span class="tooltip-text" data-lang-key-html="tooltip_replacementCost">Вартість заміни акумуляторного блоку у відсотках від початкових капітальних витрат.</span>
                        </div>
                        <div class="input-group">
                            <label for="replacementYear" class="input-label" data-lang-key="replacementYear">Рік заміни</label>
                            <div class="relative">
                                <input type="number" id="replacementYear" class="input-field pr-14" value="12">
                                <span class="unit" data-lang-key="unit_year">Рік</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_replacementYear">Рік, у якому планується провести повну заміну акумуляторних модулів. Модель Lazard використовує "аугментацію" замість повної заміни.</span>
                        </div>
                    </section>
                    <section>
                        <h2 class="text-xl font-light mb-4 border-b border-gray-300 pb-2" data-lang-key="finParams">Фінансові параметри</h2>
                        <div class="input-group">
                            <label for="ppaPrice" class="input-label" data-lang-key="ppaPrice">Ціна продажу (PPA), Рік 1</label>
                            <div class="relative">
                                <input type="number" id="ppaPrice" class="input-field pr-24" value="200">
                                <span class="unit">$/МВт·год</span>
                            </div>
                             <span class="tooltip-text" data-lang-key-html="tooltip_ppaPrice">Ціна, за якою система продає 1 МВт·год енергії в перший рік роботи.</span>
                        </div>
                        <div class="input-group">
                            <label for="ppaEscalation" class="input-label" data-lang-key="ppaEscalation">Індексація PPA</label>
                            <div class="relative">
                                <input type="number" id="ppaEscalation" class="input-field pr-16" value="2">
                                <span class="unit" data-lang-key="unit_perYear">% / рік</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_ppaEscalation">Щорічне зростання ціни продажу енергії (PPA) для врахування інфляції або ринкових умов.</span>
                        </div>
                        <div class="input-group">
                            <label for="projectLifetime" class="input-label" data-lang-key="projectLifetime">Термін служби проєкту</label>
                            <div class="relative">
                                <input type="number" id="projectLifetime" class="input-field pr-16" value="20">
                                <span class="unit" data-lang-key="unit_years">Років</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_projectLifetime">Загальний період, протягом якого проєкт буде експлуатуватися та аналізуватися.<br><br>Типове значення: 20 років.</span>
                        </div>
                        <div class="input-group">
                            <label for="discountRate" class="input-label" data-lang-key="discountRate">Ставка дисконтування</label>
                            <div class="relative">
                                <input type="number" id="discountRate" class="input-field pr-12" value="7.5">
                                <span class="unit">%</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_discountRate">Норма дохідності для приведення майбутніх грошових потоків до їхньої сьогоднішньої вартості.<br><br>Типовий діапазон (WACC): 4.2% - 10.0%.</span>
                        </div>
                         <div class="input-group">
                            <label for="inflationRate" class="input-label" data-lang-key="inflationRate">Рівень інфляції</label>
                            <div class="relative">
                                <input type="number" id="inflationRate" class="input-field pr-12" value="2.5">
                                <span class="unit">%</span>
                            </div>
                            <span class="tooltip-text" data-lang-key-html="tooltip_inflationRate">Середньорічний темп знецінення грошей, що використовується для розрахунку реальних показників.<br><br>Типове значення: ~2.0%.</span>
                        </div>
                    </section>
                </div>
                <div class="text-right mt-8 pt-6 border-t border-gray-300 space-x-2">
                    <button id="exportBtn" class="win-button hidden" data-lang-key="exportBtn">Експортувати в Excel</button>
                    <button id="calculateBtn" class="win-button win-button-primary" data-lang-key="calculateBtn">Розрахувати</button>
                </div>
                <section id="results" class="mt-10 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-light" data-lang-key="resultsTitle">Результати моделювання</h2>
                        <div class="unit-switch-container">
                             <span class="switch-label">¢/кВт·год</span>
                             <label class="unit-switch">
                                 <input type="checkbox" id="unitToggle">
                                 <span class="slider"></span>
                             </label>
                             <span class="switch-label">$/МВт·год</span>
                        </div>
                    </div>
                     <div class="win-card p-6">
                        <table class="result-table">
                            <tbody>
                                <tr>
                                    <td>
                                        <span data-lang-key="resNetCapitalCost">Чисті капітальні витрати</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resNetCapitalCost">Загальна початкова вартість проєкту без урахування фінансування.</span>
                                    </td>
                                    <td id="resNetCapitalCostValue">$0</td>
                                </tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resRte">ККД повного циклу</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resRte">Ефективність системи 'туди-назад', враховуючи втрати при заряді та розряді.</span>
                                    </td>
                                    <td id="resRteValue">0%</td>
                                </tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resEnergyChargedY1">Зарядка від мережі (Рік 1)</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resEnergyChargedY1">Загальна кількість енергії, яку система споживе з мережі для зарядки протягом першого року.</span>
                                    </td>
                                    <td id="resEnergyChargedY1Value">0 МВт·год</td>
                                </tr>
                                <tr><td colspan="2" class="!py-4"></td></tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resLcoeNominal">LCOE (номінальний)</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resLcoeNominal">Нормована вартість енергії в номінальних доларах (без поправки на інфляцію).</span>
                                    </td>
                                    <td id="resLcoeNominalValue">0.00</td>
                                </tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resLcoeReal">LCOE (реальний)</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resLcoeReal">Нормована вартість енергії в реальних доларах (з поправкою на інфляцію).</span>
                                    </td>
                                    <td id="resLcoeRealValue">0.00</td>
                                </tr>
                                <tr><td colspan="2" class="!py-4"></td></tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resPpaY1">Ціна PPA (Рік 1)</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resPpaY1">Початкова ціна продажу електроенергії.</span>
                                    </td>
                                    <td id="resPpaY1Value">0.00</td>
                                </tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resLppaNominal">LPPA (номінальний)</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resLppaNominal">Нормована (усереднена за весь термін) ціна продажу енергії в номінальних доларах.</span>
                                    </td>
                                    <td id="resLppaNominalValue">0.00</td>
                                </tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resLppaReal">LPPA (реальний)</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resLppaReal">Нормована (усереднена за весь термін) ціна продажу енергії в реальних доларах.</span>
                                    </td>
                                    <td id="resLppaRealValue">0.00</td>
                                </tr>
                                <tr><td colspan="2" class="!py-4"></td></tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resNpv">Чиста приведена вартість (NPV)</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resNpv">Різниця між дисконтованими доходами та витратами. Позитивне значення вказує на прибутковість.</span>
                                    </td>
                                    <td id="resNpvValue">$0</td>
                                </tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resIrr">Внутрішня норма дохідності (IRR)</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resIrr">Ставка дисконтування, за якої NPV проєкту дорівнює нулю. Показує очікувану дохідність інвестицій.</span>
                                    </td>
                                    <td id="resIrrValue">0.00%</td>
                                </tr>
                                <tr>
                                    <td>
                                        <span data-lang-key="resPaybackYear">Рік досягнення IRR (окупність)</span>
                                        <span class="tooltip-text" data-lang-key-html="tooltip_resPaybackYear">Рік, у якому дисконтовані доходи проєкту перевищують його дисконтовані витрати.</span>
                                    </td>
                                    <td id="resPaybackYearValue">0</td>
                                </tr>
                            </tbody>
                        </table>
                     </div>
                     <div id="charts-container" class="mt-10 grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-xl font-light mb-4 text-center" data-lang-key="chart_cashflow">Річні грошові потоки</h3>
                            <div class="win-card p-4"><canvas id="cashflowChart"></canvas></div>
                        </div>
                        <div>
                            <h3 class="text-xl font-light mb-4 text-center" data-lang-key="chart_degradation">Деградація ємності</h3>
                            <div class="win-card p-4"><canvas id="degradationChart"></canvas></div>
                        </div>
                        <div class="lg:col-span-2">
                             <h3 class="text-xl font-light mb-4 text-center" data-lang-key="chart_cumulativeNpv">Кумулятивний дисконтований грошовий потік (NPV)</h3>
                             <div class="win-card p-4"><canvas id="cumulativeNpvChart"></canvas></div>
                        </div>
                     </div>
                </section>
            </div>

            <div id="formulas-page" class="page-content hidden win-card p-6 sm:p-8">
                <h2 class="text-2xl font-light mb-6" data-lang-key="formulasTitle">Використані формули та метрики</h2>
                <div data-lang-key-html="formulasContent">
                    </div>
            </div>

            <div id="contacts-page" class="page-content hidden win-card p-6 sm:p-8">
                <h2 class="text-2xl font-light mb-6" data-lang-key="contactsTitle">Контакти</h2>
                <div data-lang-key-html="contactsContent">
                </div>
            </div>
        </main>
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>

